YUI.add("hermes-template-print-button",function(n,e){var t=n.Template.Handlebars.revive({1:function(n,e,t,l,r){var o,a=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return" "+n.escapeExpression("function"==typeof(o=null!=(o=a(t,"iconSize")||(null!=e?a(e,"iconSize"):e))?o:n.hooks.helperMissing)?o.call(null!=e?e:n.nullContext||{},{name:"iconSize",hash:{},data:r,loc:{start:{line:3,column:52},end:{line:3,column:64}}}):o)},compiler:[8,">= 4.3.0"],main:function(n,e,t,l,r){var o,a=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'<div class="print-button-container">\n\t<a role="button" class="print-button">\n\t\t<svg class="icon icon-cart_hollow'+(null!=(o=a(t,"if").call(null!=e?e:n.nullContext||{},null!=e?a(e,"iconSize"):e,{name:"if",hash:{},fn:n.program(1,r,0),inverse:n.noop,data:r,loc:{start:{line:3,column:35},end:{line:3,column:71}}}))?o:"")+'"><use xlink:href="#icon-cart_hollow"></use></svg>\n\t</a>\n</div>'},useData:!0}),l={};n.Array.each([],function(e){var t=n.Template.get("hermes/"+e);t&&(l[e]=t)}),n.Template.register("hermes/print-button",function(e,r){return r=r||{},r.partials=r.partials?n.merge(l,r.partials):l,t(e,r)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-print-icon-tooltip",function(e,n){var t=e.Template.Handlebars.revive({compiler:[8,">= 4.3.0"],main:function(e,n,t,a,l){var s=null!=n?n:e.nullContext||{},i=e.hooks.helperMissing,r=e.escapeExpression,o=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return'<div class="print-icon-tooltip-container">\n\t<header>\n\t\t<h3>'+r((o(t,"intlMessage")||n&&o(n,"intlMessage")||i).call(s,{name:"intlMessage",hash:{intlName:"common.NEW"},data:l,loc:{start:{line:3,column:6},end:{line:3,column:43}}}))+'</h3>\n\t\t<svg class="close-x-button"><use xlink:href="#icon-close"></use></svg>\n\t</header>\n\t<div class="print-icon-description">\n\t\t<span>'+r((o(t,"intlMessage")||n&&o(n,"intlMessage")||i).call(s,{name:"intlMessage",hash:{intlName:"prints.PRINT_TOOLTIP_TEXT_1"},data:l,loc:{start:{line:7,column:8},end:{line:7,column:62}}}))+'</span>\n\t\t<a href="/prints">'+r((o(t,"intlMessage")||n&&o(n,"intlMessage")||i).call(s,{name:"intlMessage",hash:{intlName:"common.LEARN_MORE"},data:l,loc:{start:{line:8,column:20},end:{line:8,column:64}}}))+'</a>\n\t</div>\n\t<div class="print-icon-fine-print">'+r((o(t,"intlMessage")||n&&o(n,"intlMessage")||i).call(s,{name:"intlMessage",hash:{intlName:"prints.PRINT_TOOLTIP_TEXT_2"},data:l,loc:{start:{line:10,column:36},end:{line:10,column:90}}}))+"</div>\n</div>\n"},useData:!0}),a={};e.Array.each([],function(n){var t=e.Template.get("hermes/"+n);t&&(a[n]=t)}),e.Template.register("hermes/print-icon-tooltip",function(n,l){return l=l||{},l.partials=l.partials?e.merge(a,l.partials):a,t(n,l)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-prepare-print-modal",function(e,t){var a=e.Template.Handlebars.revive({compiler:[8,">= 4.3.0"],main:function(e,t,a,n,l){var s,i=null!=t?t:e.nullContext||{},r=e.hooks.helperMissing,o=e.escapeExpression,c=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="prepare-print-modal-container loading">\n\t<div class="loading-container">\n\t\t<span class="preparing-text">'+o((c(a,"intlMessage")||t&&c(t,"intlMessage")||r).call(i,{name:"intlMessage",hash:{intlName:"prints.PREPARING_YOUR_PHOTO"},data:l,loc:{start:{line:3,column:31},end:{line:3,column:85}}}))+'</span>\n\t\t<span class="flickr-balls-container">\n'+(null!=(s=e.invokePartial(c(n,"flickr-balls"),t,{name:"flickr-balls",data:l,indent:"\t\t\t",helpers:a,partials:n,decorators:e.decorators}))?s:"")+'\t\t</span>\n\t</div>\n\t<div class="error-container">\n\t\t<h1>'+o((c(a,"intlMessage")||t&&c(t,"intlMessage")||r).call(i,{name:"intlMessage",hash:{intlName:"common.OOPS"},data:l,loc:{start:{line:9,column:6},end:{line:9,column:44}}}))+'</h1>\n\t\t<p class="error-message"></p>\n\t\t<div class="button-container">\n\t\t\t<button class="mini alt cancel-button">'+o((c(a,"intlMessage")||t&&c(t,"intlMessage")||r).call(i,{name:"intlMessage",hash:{intlName:"common.CANCEL"},data:l,loc:{start:{line:12,column:42},end:{line:12,column:82}}}))+'</button>\n\t\t\t<button class="mini action retry-button">'+o((c(a,"intlMessage")||t&&c(t,"intlMessage")||r).call(i,{name:"intlMessage",hash:{intlName:"common.RETRY"},data:l,loc:{start:{line:13,column:44},end:{line:13,column:83}}}))+"</button>\n\t\t</div>\n\t</div>\n</div>"},usePartial:!0,useData:!0}),n={};e.Array.each(["flickr-balls"],function(t){var a=e.Template.get("hermes/"+t);a&&(n[t]=a)}),e.Template.register("hermes/prepare-print-modal",function(t,l){return l=l||{},l.partials=l.partials?e.merge(n,l.partials):n,a(t,l)})},"@VERSION@",{requires:["template-base","handlebars-base","hermes-template-flickr-balls"]});YUI.add("prepare-print-modal-view",function(e,r){require("hermes-core/flog")(r);e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){},buildContainer:function(){this.setContainerWithTemplate("prepare-print-modal")},activate:function(){var e=this,r=this.get("container");this.contentContainer=r.one(".prepare-print-modal-container"),this.loadingContainer=r.one(".loading-container"),this.errorContainer=r.one(".error-container"),this.errorTextContainer=this.errorContainer.one(".error-message"),this.errorRetryButton=this.errorContainer.one("button.retry-button"),this.errorCancelButton=this.errorContainer.one("button.cancel-button"),this.registerEventHandler(this.errorRetryButton.on("click",function(){e.fire("retryClicked")})),this.registerEventHandler(this.errorCancelButton.on("click",function(){e.fire("closeClicked")}))},showError:function(e){this.contentContainer.removeClass("loading"),this.contentContainer.addClass("error"),e&&this.errorTextContainer.set("text",e)},showLoading:function(){this.contentContainer.addClass("loading"),this.contentContainer.removeClass("error")}})},"@VERSION@",{requires:["flickr-view","hermes-template-prepare-print-modal"],langBundles:["common","prints"]});YUI.add("hermes-lang-prints_ko-kr",function(_,T){_.Intl.add("hermes/prints","ko-KR",{PRINTS:["프린트"],SIGNUP_MODAL_TITLE:["놀라운 프린트를 경험하세요!"],SIGNUP_MODAL_MESSAGE:["Flickr에 가입하여 놀라운 프린트 랩에 액세스하여 모든 사진을 확인하세요."],GET_STARTED:["시작하기"],PRINTS_AND_GIFTS:["프린트 및 월 아트"],VIEW_CART:["카트 보기"],VIEW_CART_WITH_COUNT:["카트 보기(","${count}",")"],BUY_PRINTS:["프린트 구매"],PHOTO_BOOKS_MENU_TEXT:["포토북"],CHOOSE_PHOTO_TO_GET_PRINTS:["프린트와 월 아트를 받을 사진을 선택하세요."],BUY_PRINTS_MENU_TEXT:["프린트 구매"],CHOOSE_YOUR_PHOTO_TO_GET_PRINTS:["프린트와 월 아트를 받을 사진 중에서 하나를 선택하세요."],LEARN_MORE_THEN_FEEDBACK:['<a class="learn-link" href="',"${learnUrl}",'" target="_blank">자세히 알아본</a> 후 <a class="feedback-link" href="',"${feedbackUrl}",'" target="_blank">생각을 알려주세요!</a>'],GET_PRINTS:["프린트 가져오기"],THANKS_FOR_YOUR_ORDER:["주문해 주셔서 감사합니다!"],YOUR_ORDER_NUMBER_IS:['주문 번호는 <a class="order-link" href="',"${orderUrl}",'" target="_blank">',"${orderNum}","</a>입니다."],YOULL_RECEIVE_ORDER_EMAIL:['주문 세부 정보가 포함된 이메일이 <span class="email-span">',"${email}","</span>(으)로 전송됩니다."],HAVE_QUESTIONS_LINE:['질문이 있으신가요? <a class="help-link" href="',"${helpUrl}",'" target="_blank">도움말 센터</a>를 확인하세요.'],WE_WELCOME_FEEDBACK_HERE:['<a class="feedback-link" href="',"${feedbackUrl}",'" target="_blank">여기에 피드백을</a> 보내주세요.'],PRINT_TOOLTIP_TEXT:["이제 나만의 사진에 대한 프린트와 월 아트를 가져올 수 있습니다. (이것은 자신의 사진에 대해서만 사용할 수 있습니다)"],PRINT_TOOLTIP_TEXT_1:["이제 나만의 사진에 대한 프린트와 월 아트를 가져올 수 있습니다."],PRINT_TOOLTIP_TEXT_2:["(이 서비스는 자신의 사진에 대해서만 사용할 수 있습니다)"],GET_PRINTS_WALL_ART_TITLE:["자신의 사진에 대한 프린트와 월 아트 가져오기"],GET_PRINTS_WALL_ART_DESCRIPTION:["여러 사이즈와 스타일에서 금속, 캔버스 또는 종이 프린트를 선택합니다."],SELECT_FROM_YOUR_PHOTOS:["자신의 사진에서 선택"],ENGLISH_LANGUAGE_AHEAD:["영어가 먼저 나옵니다!"],ORDERING_IS_ENGLISH_ONLY:["주문 프로세스는 현재 영어로만 제공됩니다. 영어를 읽기가 수월하다면 계속 진행하세요."],CONTINUE_IN_ENGLISH:["영어로 계속"],PRINTS_AND_WALL_ART:["프린트 및 월 아트"],GET_STUNNING_WALL_ART:["자신의 사진에 대한 멋진 월 아트와 고급 프린트 가져오기"],GET_STUNNING_ALL:["자신의 사진에 대한 멋진 월 아트와 고급 프린트 가져오기"],CHOOSE_PHOTOS:["사진 선택"],METAL_PRINTS:["금속 프린트"],METAL_PRINTS_DESCRIPTION:["금속 프린트는 그 외 다른 사진 월 아트와는 다른 깊이와 선명도를 보여주는 탁월한 색상과 생동감을 선사합니다. 가장 웅장한 사진만큼 굵은 글씨를 인쇄하려면 금속 프린트가 아닌 다른 것을 찾지 마세요."],PAPER_PRINTS:["종이 프린트"],PAPER_PRINTS_DESCRIPTION:["종이 프린트는 좋아하는 사진을 과시하고 공유할 수 있는 전통적인 방법입니다. 4x6 스택부터 프레임 가능한 스테이트먼트 피스까지 모든 사진에 적합한 크기 및 용지 마감을 찾을 수 있습니다."],CANVAS_PRINTS:["캔버스 프린트"],CANVAS_PRINTS_DESCRIPTION:["가정, 사무실 또는 그 외 클래식 캔버스 프린트가 필요한 공간에 작은 클래스를 추가하세요. 사진을 걸고 싶을 때 완벽한 모양과 크기로 이미지가 탁월해 보입니다."],WHO_CAN_PRINT_PHOTOS_QUESTION:["누가 내 사진을 프린트할 수 있나요?"],WHO_CAN_PRINT_PHOTOS_ANSWER:["오직 나만이 Flickr를 통해 사진을 프린트할 수 있습니다. 계정 방문자에게는 사진을 프린트할 수있는 옵션이 표시되지 않습니다."],WHO_CAN_PRINT_PHOTOS_ANSWER_CONTROL:["사진을 프린트할 수 있는 사람을 완전히 제어할 수 있습니다. 자신만 계속 프린트하거나, 친구들과 공유하거나, 전 세계 모든 사람과 공유하고 사진의 가치를 인정받고 있다는 만족감을 누려보세요."],WHO_MAKES_PRINTS_QUESTION:["누가 프린트와 월 아트를 만드나요?"],WHO_MAKES_PRINTS_ANSWER:["Flickr Prints는 SmugMug가 아름다운 이미지를 프린트하면서 쌓은 수년간의 경험을 통해 이익을 얻습니다. 지역에 따라 프린트는 Bay Photo, White House Custom Colour 또는 Loxley Colour에서 제공됩니다. 저희가 사용하는 랩은 모두 색상 재현성이 뛰어나고 환상적인 명성을 자랑합니다."],HOW_LONG_SHIP_QUESTION:["배송이 얼마나 걸리나요?"],HOW_LONG_SHIP_ANSWER:["160여 개국을 포함하여 전 세계로 배송합니다. 어디에 있든 최대한 신속하게 프린트를 배송해 드립니다. 빠른 배송을 통해 프린트를 훨씬 더 신속하게 받을 수 있습니다."],WHAT_IF_WRONG_ORDER_QUESTION:["주문에 어떤 문제가 생기면 어떻게 되나요?"],WHAT_IF_WRONG_ORDER_ANSWER:['프린트나 월 아트에 불미스러운 일이 생기면 Flickr에서 올바르게 처리합니다. 주문 접수 후 30일 이내에 이메일을 보내주시면 도와드리겠습니다. 문제가 있으시면 <a class="support-link" href="',"${supportUrl}",'" target="_blank">지원 담당자에게 연락하세요</a>.'],WHERE_PHOTO_BOOK_QUESTION:["포토북을 어디에서 만들 수 있나요?"],WHERE_PHOTO_BOOK_ANSWER:["저희는 하드커버와 소프트커버 포토북을 위해 Blurb 및 Chatbooks와 협력하고 있습니다. Flickr 포토 스트림과 앨범은 북 제작 과정에 원활하게 통합됩니다. 포토북을 확인하세요."],WHERE_PHOTO_BOOK_ANSWER_WITH_LINKS:['저희는 하드커버와 소프트커버 포토북을 위해 <a class="blurb-link" href="',"${blurbUrl}",'" target="_blank">Blurb</a> 및 <a class="chatbooks-link" href="',"${chatbooksUrl}",'" target="_blank">Chatbooks</a>와 협력하고 있습니다. Flickr 포토 스트림과 앨범은 북 제작 과정에 원활하게 통합됩니다. <a class="photo-books-link" href="',"${photoBooksUrl}",'" target="_blank">포토북을 확인하세요.</a>'],MORE_QUESTIONS_QUESTION:["질문이 더 있으신가요?"],MORE_QUESTIONS_ANSWER:['<a class="help-link" href="',"${helpUrl}",'" target="_blank">Flickr 도움말 센터</a>를 방문하여 자세한 정보를 확인하거나 지원 담당자와 연락하세요.'],PREPARING_YOUR_PHOTO:["사진 준비 중..."],SOMETHING_WRONG_PREPARING_PRINT:["프린트할 사진을 준비하는 중 오류가 발생했습니다."],MID_PAGE_PHOTO_ATTRIBUTION:["${photoOwner}","의 사진."],UNSUPPORTED_FILE_TYPE_PLEASE_JPG:["지원되지 않는 파일 유형입니다. 프린트하려면 JPG 파일을 사용하세요."],PRINT_PHOTOS_WITH_EASE:["최고의 스튜디오에서 쉽게 원하는 사진을 출력할 수 있습니다."]})},"@VERSION@",{requires:["intl"]});YUI.add("photo-prints-helper",function(e,r){var t=require("url-parse"),i=require("hermes-core/flog")(r),n=require("superagent"),s=e.mix({langBundles:["prints"]},e.Localizable),o={default:"prints.SOMETHING_WRONG_PREPARING_PRINT",4:"prints.UNSUPPORTED_FILE_TYPE_PLEASE_JPG"};e.PhotoPrintsHelper=function(r){var a=e.config.flickr.flickrprints.devBaseUrl,l=e.config.flickr.flickrprints.baseUrl,c=e.config.flickr.flickrprints.cartPath,p=e.config.flickr.flickrprints.devApiKey,u=e.config.flickr.flickrprints.apiKey;return{isPrintsEnabled:function(){return r.getViewer().signedIn||!r.getViewer().signedIn&&r.flipper.isFlipped("enable-others-to-print")},canPrintPhoto:function(e){return this.isPrintsEnabled()&&!e.getValue("isVideo")&&(e.getValue("isOwner")||r.flipper.isFlipped("enable-others-to-print")&&!e.getValue("isOwner")&&e.getValue("engagement").getValue("canPrint"))},registerPrint:function(t,i){var n=this;return r.callAPI("flickr.printservice.getRedirectURL",{user_id:t.getValue("owner").getValue("id"),photo_id:t.getValue("id"),return_url:i}).then(function(r){return n.isPrintUrlSafe(r.redirectURL)?{redirectURL:r.redirectURL}:e.Promise.reject({message:n.getRegisterPrintErrorCodeMessage()})}).catch(function(e){throw{message:n.getRegisterPrintErrorCodeMessage(e.code)}})},isPrintUrlSafe:function(e){var r=new t(e);return"https:"===r.protocol&&"https://"+r.hostname===this.getBaseUrl()},getBaseUrl:function(){return r.flipper.isFlipped("enable-photo-prints-prod-url")?l:a},getApiKey:function(){return r.flipper.isFlipped("enable-photo-prints-prod-url")?u:p},getCartUrl:function(){return this.getBaseUrl()+c},fetchCartCount:function(){var e=this.getBaseUrl()+"/api/v2/cart?APIKey="+this.getApiKey();return n.get(e).withCredentials().set("Accept","application/json").then(function(e){return{count:e&&e.body.Response.Cart?e.body.Response.Cart.ItemCount:0}}).catch(function(e){throw i.error("Error fetching cart count",{err:e}),e})},fetchOrder:function(e){var r=this.getBaseUrl()+"/api/v2/order/"+e+"?_expand=OrderBillingAddress&APIKey="+this.getApiKey();return n.get(r).withCredentials().set("Accept","application/json").then(function(r){var t="/api/v2/order/"+e+"!billingaddress",i=r.body.Response.Order,n=r.body.Expansions[t];return{orderId:i.OrderID,orderUrl:i.WebUri,email:n.OrderBillingAddress.Email}})},getRegisterPrintErrorCodeMessage:function(e){var r=e?e.toString():"";return o.hasOwnProperty(r)?s.intlMessage({intlName:o[r]}):s.intlMessage({intlName:o.default})}}}},"@VERSION@",{requires:[]});YUI.add("print-button-view",function(t,i){require("hermes-core/flog")(i);t.FlickrView.create(this.name,t.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(i){this.params=i,this.disableClicks=i.disableClicks,this.iconSize=void 0!==i.iconSize?i.iconSize:"normal",this.photoPrintsHelper=new t.PhotoPrintsHelper(this.appContext),this.selectors={printButton:".print-button-container .print-button",newLabel:".print-button-container .label-beta"}},loadState:function(){var t=this;return this.appContext.getModel("photo-models",this.params.photoId).then(function(i){t.photoModel=i})},buildContainer:function(){this.setContainerWithTemplate("print-button",{iconSize:this.iconSize})},activate:function(){var t=this.get("container");this.printButtonNode=t.one(this.selectors.printButton),this.printNewLabelNode=t.one(this.selectors.newLabel),this.disableClicks||(this.printButtonNode&&this.registerEventHandler(this.printButtonNode.on("click",this.handlePrintClick.bind(this))),this.printNewLabelNode&&this.registerEventHandler(this.printNewLabelNode.on("click",this.showPrintTooltip.bind(this))))},handlePrintClick:function(){"en-us"===this.appContext.lang.toLowerCase()?this.preparePrint():this.showEnglishWarningModal()},preparePrint:function(){var i=this;this.showPreparingPrintModal(),this.photoPrintsHelper.registerPrint(this.photoModel,t.config.win.location.href).then(function(i){t.config.win.location.href=i.redirectURL}).catch(function(t){i.preparePrintModalSubview.showError(t.message||i.intlMessage({intlName:"prints.SOMETHING_WRONG_PREPARING_PRINT"}))})},showEnglishWarningModal:function(i){var e=this;this.englishWarningModal=new t.Views.FluidModal({appContext:this.appContext,dismissOnOverlayClick:!1,showActionButton:!0,actionButtonLabel:this.intlMessage({intlName:"prints.CONTINUE_IN_ENGLISH"}),showCancelButton:!0,cancelButtonLabel:"en-us"===this.appContext.lang.toLowerCase()?this.intlMessage({intlName:"common.GO_BACK_BUTTON"}):this.intlMessage({intlName:"common.CANCEL"}),showCancelX:!1,showHeader:!0,showFooter:!0,title:this.intlMessage({intlName:"prints.ENGLISH_LANGUAGE_AHEAD"}),message:this.intlMessage({intlName:"prints.ORDERING_IS_ENGLISH_ONLY"}),hideModalOverlay:!1}),this.englishWarningModal.show(),this.englishWarningModal.on("actionClick",function(){e.englishWarningModal.close(),setTimeout(function(){e.preparePrint()},0)})},showPreparingPrintModal:function(){var i=this;this.preparePrintModalSubview=new t.Views["prepare-print-modal-view"]({appContext:this.appContext}),this.preparingPrintModal=new t.Views.FluidModal({appContext:this.appContext,dismissOnOverlayClick:!1,showActionButton:!1,showCancelButton:!1,showCancelX:!1,showHeader:!1,showFooter:!1,subview:this.preparePrintModalSubview,hideModalOverlay:!1,contentPadding:0}),this.preparingPrintModal.show(),this.preparePrintModalSubview.on("retryClicked",function(){i.preparingPrintModal.close(),setTimeout(function(){i.preparePrint()},0)}),this.preparePrintModalSubview.on("closeClicked",function(){i.preparingPrintModal.close()})},showPrintTooltip:function(){var i,e=this,n=this.printButtonNode;n&&(this.tooltip=new t.Views.FluidDroparound({appContext:this.appContext,htmlMessage:this.templates("print-icon-tooltip")({}),showDropArrow:!0,dismissOnOverlayClick:!0,observePageResize:!0,anchorElement:n,keyboardAnchorElement:n,minVerticalSpace:400,width:300,positionFixed:!0,preferLeft:!0,closeOnScroll:!0,anchorOffsetHorizontal:2,anchorOffsetVertical:0}),i=this.tooltip.get("container"),this.registerEventHandler(i.delegate("click",function(t){e.tooltip.close()},".close-x-button")),this.tooltip.show())}})},"@VERSION@",{requires:["flickr-view","hermes-template-print-button","hermes-template-print-icon-tooltip","prepare-print-modal-view","photo-prints-helper"],optional:["photo-models"],langBundles:["common","prints"]});YUI.add("photo-card-helper",function(e,t){e.mix({langBundles:["common","feed","feed-new"]},e.Localizable);var o=require("justified-layout");e.PhotoCardHelper=function(t){var a={layoutValues:{large:{BATCH_CARD_SPACING:4,BATCH_TARGET_ROW_HEIGHT:150,BATCH_TARGET_ROW_HEIGHT_TOLERANCE:.3,BATCH_ROW_HEIGHT_RATIO:.5},medium:{BATCH_CARD_SPACING:4,BATCH_TARGET_ROW_HEIGHT_TOLERANCE:.3},compact:{BATCH_CARD_SPACING:8,BATCH_TARGET_ROW_HEIGHT:180,BATCH_TARGET_ROW_HEIGHT_TOLERANCE:.3,SINGLE_PHOTO_HEIGHT:250}},ATTRIBUTION_HEADER_HEIGHT:58,DETAILS_FOOTER_HEIGHT:70,INFO_BAR_HEIGHT:52,MAX_PHOTO_AR:2.5,MIN_PHOTO_AR:.5,MANUAL_PORTRAIT_AR:.75,MANUAL_LANDSCAPE_AR:2,getCappedPhotoHeight:function(e){e.height;return Math.min(e.height,Math.max(t.viewportData.getHeight()*e.viewportProportion-e.additionalCardHeight,e.minHeight))},getClampedPhotoAspectRatio:function(e){return Math.min(Math.max(e,this.MIN_PHOTO_AR),this.MAX_PHOTO_AR)},generateCompactBatchLayout:function(e){var t,a=this,i=[],u=1===e.photoItems.length?this.layoutValues.compact.SINGLE_PHOTO_HEIGHT:this.layoutValues.compact.BATCH_TARGET_ROW_HEIGHT;i=e.photoItems.map(function(e){return a.getClampedPhotoAspectRatio(e.aspectRatio)}),(t=o(i,{containerWidth:e.width,containerPadding:0,boxSpacing:{horizontal:this.layoutValues.compact.BATCH_CARD_SPACING,vertical:this.layoutValues.compact.BATCH_CARD_SPACING},targetRowHeight:u,targetRowHeightTolerance:this.layoutValues.compact.BATCH_TARGET_ROW_HEIGHT_TOLERANCE})).width=e.width;var n=t.boxes[0].top,s=[0],l=0;return t.boxes.some(function(e,o){if(e.top>n){if(l+=t.boxes[s[s.length-1]].height+a.layoutValues.compact.BATCH_CARD_SPACING,s.push(o),s.length>3)return!0;n=e.top}}),s.length>3&&(t.boxes=t.boxes.slice(0,s[s.length-1]),t.containerHeight=l),t},generateThreeMaxLayout:function(e){var o=this,a={},i=[],u=[],n=e.photoItems.length;return u=e.photoItems.map(function(e){return o.getClampedPhotoAspectRatio(e.aspectRatio)}),2===(u=u.slice(0,3)).length?u[0]>1&&u[1]>1?(i.push(u.slice(0,1)),i.push(u.slice(1,2)),a=this.buildCustomRowsLayout(i,e)):(i.push(u.slice(0,2)),a=this.buildCustomRowsLayout(i,e)):3===u.length&&(u[0]>1&&u[1]>1&&u[2]>1?(i.push(u.slice(0,1)),i.push(u.slice(1,3)),a=this.buildCustomRowsLayout(i,e)):u[0]>1&&u[1]>1&&u[2]<=1?(i.push(u.slice(0,1)),i.push(u.slice(1,3)),a=this.buildCustomRowsLayout(i,e)):u[0]>1&&u[1]<=1&&u[2]>1?(i.push(u.slice(0,1)),i.push(u.slice(1,3)),a=this.buildCustomRowsLayout(i,e)):u[0]>1&&u[1]<=1&&u[2]<=1?(i.push(u.slice(0,1)),i.push(u.slice(1,3)),a=this.buildCustomRowsLayout(i,e)):u[0]<=1&&u[1]>1&&u[2]>1?(n>3?i.push(u.slice(0,2)):(i.push(u.slice(0,2)),i.push(u.slice(2,3))),a=this.buildCustomRowsLayout(i,e)):u[0]<=1&&u[1]>1&&u[2]<=1?(i.push(u.slice(0,2)),a=this.buildCustomRowsLayout(i,e)):u[0]<=1&&u[1]<=1&&u[2]>1?(n>3?i.push(u.slice(0,2)):(i.push(u.slice(0,2)),i.push(u.slice(2,3))),a=this.buildCustomRowsLayout(i,e)):u[0]<=1&&u[1]<=1&&u[2]<=1&&(i.push(u.slice(0,3)),a=this.buildCustomRowsLayout(i,e))),Math.max.apply(Math,a.boxes.map(function(e){return e.height}))>.8*t.viewportData.getHeight()&&((i=[]).push(u.slice(0,2)),a=this.buildCustomRowsLayout(i,e)),a},buildCustomRowsLayout:function(e,t){var o=this,a=0,i={boxes:[]};return e.forEach(function(u,n){var s={horizontal:o.layoutValues.large.BATCH_CARD_SPACING,vertical:o.layoutValues.large.BATCH_CARD_SPACING},l=o.generateCustomJustifiedRow(u,{containerWidth:t.width,padding:s.horizontal,top:0===n?0:a});i.boxes=i.boxes.concat(l),a+=n!==e.length-1?l[0].height+s.vertical:l[0].height}),i.containerHeight=a,i},generateCustomJustifiedRow:function(e,t){var o=e.reduce(function(e,t,o){return e+t},0),a=(t.containerWidth-t.padding*(e.length-1))/o,i=0;return e.map(function(e,o){var u=i;return i+=a*e+t.padding,{aspectRatio:e,width:a*e,height:a,left:u,top:t.top}})},scaleLayout:function(e,t,o,a,i){var u,n=0,s=0,l=[];return e.boxes.forEach(function(e,o){a||(e.width*=t,e.left*=t),i||(e.height*=t,e.top*=t)}),l.push([]),e.boxes.forEach(function(e,t){e.top>s&&(n++,s=e.top,l.push([])),l[n].push(e)}),u=0,l.forEach(function(n,s){var h=o,r=h*t,c=0;n.forEach(function(e,t){a||(e.width-=(h-r)*(n.length-1)/n.length,e.left=c+t*h,c+=e.width),i||(e.height-=(h-r)*(l.length-1)/l.length,e.top=u+s*h,t===n.length-1&&(u+=n[0].height))}),a||(e.width=c+(n.length-1)*h)}),i||(e.containerHeight=u+(l.length-1)*o),e},convertPhotoModel:function(t){var o=t.getValue("owner"),a=t.getValue("engagement"),i=o.getValue("isPro"),u=this.convertEngagementModel(a);return{id:e.guid(),layoutRenderType:"photo",photoId:t.getValue("id"),aspectRatio:t.getValue("aspectRatio"),sizes:t.getValue("sizes"),url:t.getValue("url"),title:t.getValue("title"),description:t.getValue("description"),mediaType:t.getValue("mediaType"),isVideo:t.getValue("isVideo"),owner:{nsid:o.getValue("nsid"),url:o.getValue("url"),displayname:o.getValue("displayname"),buddyicon:o.getValue("buddyicon"),pathAlias:o.getValue("pathAlias"),isPro:i,proBadgeType:i?o.getValue("proBadge"):void 0,model:t.getValue("owner")},engagement:u,isOwner:t.getValue("isOwner"),needsInterstitial:t.getValue("needsInterstitial"),safetyLevel:t.getValue("safetyLevel"),model:t,engagementModel:a}},convertEngagementModel:function(e){return"photo-lite-models"===e.registry.name?{photoId:e.getValue("id"),isFaved:e.getValue("isFaved"),faveCount:e.getValue("faveCount"),commentCount:e.getValue("commentCount"),canFave:e.getValue("canFave"),reactions:t.flipper.isFlipped("enable-likes")?e.getValue("reactions"):void 0,model:e}:{photoId:e.getValue("id"),isFaved:e.getValue("isFaved"),faveCount:e.getValue("faveCount"),commentCount:e.getValue("commentCount"),viewCount:e.getValue("viewCount"),canFave:e.getValue("canFave"),reactions:t.flipper.isFlipped("enable-likes")?e.getValue("reactions"):void 0,model:e}}};return e.augment(a,e.EventTarget),a}},"@VERSION@",{requires:["event-custom","storage-helper"]});